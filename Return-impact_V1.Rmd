---
title: "Return-impact"
author: "Peimin Lin"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo =TRUE, 
  message = FALSE,
  warning = FALSE,
  cache = TRUE,
  fig.align = "center")
library(tidyverse) 
library(pacman)
library(rio)
library(skimr)
library(broom) 
library(magrittr)
library(ROCR)
library(MASS)
library(caTools)
library(DMwR)
library(caret)
library(ggplot2)
library(patchwork)
library(vcd)
library(gridExtra)
library(knitr)
library(corrplot)
library(scales)
library(lme4)
library(DMwR)
library(InformationValue)
library(ROCR)
library(rpart)
library(randomForest)
library(xgboost)
library(xgboostExplainer)
library(ggmosaic)
library(e1071)
library(ranger)
library(penalized)
library(rpart.plot)
library(ggcorrplot)
library(caTools)
library(doMC)
library(partykit)
library(rattle)
library(jpeg)
library(png)
library(ggExtra)
library(cluster)
library(NbClust)
library(flexclust)
library(fMultivar)
library(rattle)
library(Rmixmod)
registerDoMC(cores=4)
```


```{r read_data}
positions <- readRDS("/monash-return-impact/data/position.rds")  
```



```{r}
pivit <- position %>% pivot_longer(AdT:DeuceWide,
                                    names_to = "Servetype", 
                                   values_to = "values")
posit <- pivit %>% 
  dplyr::filter(values == 1)  %>% 
  dplyr::select(-values)
```


```{r}
summarydata <- summary(position)

summarydata
```


```{r}
Khachanov <- posit %>%
  dplyr::filter(player == "K. Khachanov") %>%
  dplyr::select(X, Y, Ad, Clay, Grass)
```

# Marginal Distribution

```{r}
p1 <- ggMarginal(p, type="histogram")
 p1
```



```{r}
model <- mixmodCluster(positions[,c("X","Y")], 5)
model
```


```{r}
fit <- mixmodCluster(Khachanov, 
                     nbCluster = 2:8,
       criterion = c("BIC", "ICL", "NEC"), 
       models = mixmodGaussianModel(), 
       strategy = strategy1)

```

```{r}
kmod <- mixmodCluster( positions %>% filter(player == "Khachanov")[,c("X","Y")], 5) %>%
                plot()
kmod


```


```{r}
plot(kmod)
```




```{r}
model <- mixmodCluster(positions[,c("X","Y")], 8)
model
```


```{r}
summary(model)
```

```{r}
plot(model)
```

```{r}
model2 <- mixmodCluster(positions[,c("X","Y")], 2)
model2
```


```{r}
plot(model2)
```


```{r}
model3 <- mixmodCluster(positions[,c("X","Y")], 3)
model3
```


```{r}
plot(model3)
```

```{r}
model4 <- mixmodCluster(positions[,c("X","Y")], 4)
model4
```


```{r}
plot(model4)
```

```{r}
model5 <- mixmodCluster(positions[,c("X","Y")], 5
                        )
model5
```


```{r}
plot(model5)
```

```{r}
model["results"]
```


```{r}
model["bestResult"]
```


```{r}
model2["results"]
```


```{r}
model2["bestResult"]
```

```{r}
model3["results"]
```



```{r}
model3["bestResult"]
```

```{r}
model4["results"]
```




```{r}
model4["bestResult"]
```


```{r}
model5["results"]
```



```{r}
model5["bestResult"]
```



```{r}
summary(model)
```
















