---
title: "Return-impact"
author: "Peimin Lin"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo =TRUE, 
  message = FALSE,
  warning = FALSE,
  cache = TRUE,
  fig.align = "center")
library(tidyverse) 
library(ggplot2)
library(ggExtra)
library(cluster)
library(NbClust)
library(Rmixmod)
library(mclust)
library(naniar)
```


```{r read_data}
positions <- readRDS("/monash-return-impact/data/position.rds")  
```


```{r overview}
summarydata <- summary(positions)

summarydata
```


```{r}
gg_miss_var(positions)
```


```{r}
serveone <- positions %>% 
  dplyr::filter(serve == 1)
```



```{r}
servetwo <- positions %>% 
  dplyr::filter(serve == 2)
```



# Marginal Distribution

```{r}
ggMarginal()
```
 



# Cluster Selection 

## serve one 
```{r}
clustone <-  Mclust(serveone, 3:12)
summary(clustone)
plot(clustone, what = 'BIC', 
     legendArgs = list(x = "bottomright", ncol = 5))
```

## serve two

```{r}
clusttwo <-  Mclust(servetwo, 3:12)
summary(clusttwo)
plot(clustone, what = 'BIC', 
     legendArgs = list(x = "bottomright", ncol = 5))
```



# GMM Rmixmod

# Cluster 9 


```{r}
modelo9 <- mixmodCluster(serveone[,c("X","Y")], 9)
modelo9
plot(modelo9)
```



```{r}
models9 <- mixmodCluster(servetwo[,c("X","Y")], 9)
models9
plot(models9)
```


# Player 

```{r}
playerone <- serveone %>%
  dplyr::filter(player %in% c("N. Djokovic", "R. Federer", "D. Thiem", "A. Zverev", "D. Schwartzman", "R. Nadal", "D. Medvedev", "S. Tsitsipas", "A. Rublev", "M. Berrettini", "R. Bautista Agut", "P. Carreno Busta") |
opponent %in% c("N. Djokovic", "R. Federer", "D. Thiem", "A. Zverev", "D. Schwartzman", "R. Nadal", "D. Medvedev", "S. Tsitsipas", "A. Rublev", "M. Berrettini", "R. Bautista Agut", "P. Carreno Busta") 
                  )
```






















