---
title: "MAKING AN IMPACT: A model of return impact in professional tennis"
author:
- familyname: Curie
  othernames: Marie
  address: University of Paris
  email: mcurie.notreal@gmail.com
  correspondingauthor: true
  qualifications: Nobel Prize, PhD
- familyname: Curie
  othernames: Pierre
  address: University of Paris
  qualifications: Nobel Prize, PhD
department: Department of\newline Econometrics &\newline Business Statistics
organization: Acme Corporation
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  MonashEBSTemplates::report:
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, cache=TRUE, messages=FALSE, warning=FALSE)
# Make sure you have the latest versions of rmarkdown and bookdown installed
library(ggplot2)
library(tidyverse)
library(ggExtra)
library(cluster)
library(NbClust)
library(Rmixmod)
library(mclust)
library(naniar)
library(factoextra)
```


\clearpage

# Introduction
What positions should players stand and get a better impact on the serve return? Are there any strategies that the players used during their tennis games? As we know, the serve return is also important in tennis, however, there is lots of analysis about the tennis before and return impact analysis were not really common, mainly because the positions of the data containing the 3D position is not easy to collect and there is not too much sample for analysis. In the project, we are going to explore a model for the return impact position of the profession mal players using recently go public tracking data summaries on the ATP Tour websites of the 2D position of the ball at the time of return impact,


# Project Goals
The serve return is the shot the receiver hits off of their opponent's serve. The position use (x,y) to represent, the center of the net use (0,0),Figure \@ref(fig:court) provided the visualisation of the tennis court, the (x,y) is the length and lateral position. This project will develop a generative model for the return impact position of professional male players. Furthermore, the project will identify key contextual variables that may influence return impact, including but not limited to:
* Serve number
* Serve direction
* Surface
* Receiver
* Server
Moreover, there is a shiny dashboard designed for the project visualisation, there is a section will show the user guide about the shiny dashboard.

```{r court, out.width="70%",fig.cap= "Tennis Court"}
knitr::include_graphics("image/tennis_court.png")
```

# Overview the dataset
The data set Figure\@ref(fig:datset) includes return impact for returned points in ATP singles matches for events between 2018 and 2020. There are 25 variables and 126455 observations in this data set and each observation refers to a single point within a match. From Figure\@ref(fig:tidymiss), there is no missing value in the data set, so we omit the data wrragling this step and use the data directly. 

```{r datset, out.width="100%",fig.cap= "Data set overview"}
knitr::include_graphics("image/dataset.png")
```


```{r read_data}
position <- readRDS("data/position.rds")  
positions <- position %>% 
  mutate(hard = case_when(surface == "Hard" ~ "1",
                          surface == "Hard" ~ "0"))

```


```{r overview, out.width="50%"}
summarydata <- summary(positions)
summarydata
```

```{r tidymiss, out.width="100%", fig.cap= "Check missing value"}
gg_miss_var(positions)
```

# How variables influence playerâ€™s return impact

## Model selection

Started from the basic models to find out the relationship of the return impact. 
* Logistic Regression

* Decision Tree

* Random Forests

* Gradient Boosting


* Hierarchical Clustering


```{r}
ames_scale <- positions%>%
  select_if(is.numeric) %>% # select numeric columns
  select(-Z, -year) %>%    # remove target column -server_n, -receiver_n, -server_id, -return_id
  mutate_all(as.double) %>%  # coerce to double type
  scale() 
```




* Gaussian Mixture Model

```{r}
serveone <- positions %>% 
  dplyr::filter(serve == 1)
```


```{r}
servetwo <- positions %>% 
  dplyr::filter(serve == 2)
```

## Cluster Selection
The number of cluster components chose for the analysis was using the `Mclust` package that calculate their BIC and Figure \@ref(fig:seronems) show the trend of the BIC. 

## serve one 
```{r seronems}
clustone <-  Mclust(serveone, 3:12)
summary(clustone)
plot(clustone, what = 'BIC', 
     legendArgs = list(x = "bottomright", ncol = 5))
```

## serve two

```{r}
clusttwo <-  Mclust(servetwo, 3:12)
summary(clusttwo)
plot(clusttwo, what = 'BIC', 
     legendArgs = list(x = "bottomright", ncol = 5))
```

Compare to two serve of the difference number of cluster components' BIC, the number of 9 cluster perform well in the model. Thus, it will use 9 cluster for the rest analysis. In the shiny dashboard, there is a panel can run the function below to check the change of difference components cluster by selecting serve number, serve type, player, surface type.
```{r}
modelo9 <- mixmodCluster(serveone[,c("X","Y")], 9)
modelo9
plot(modelo9)
```

Under the result used the GMM model, there is a further discussion of the return impact base on the player, the match intensity increase and the rest of the variables.

## The strategy of top 3 players' return impact positions
Are the top players have large difference of the return impact positions? Or similar.

## Any ajust strategy in the Promotion event especially the final round?
Will player stand near or far away from the court during the semi-final ground? Or final ground? 

## How are surface type influence players'performance?
As grass and clay surface type have some slightly difference and will they influence the return impact positions?

## ATP Lefties In The Top 100 Rankings' return impact
Are the player will have similar return impact positions because they are left hand users?

## (will they change stategy when were facing familar player) 
Compare head-to-head history result, find out the player have larger win proportion and compare their each game return impact positions.

# Dashboard User Guide

# Conclusion

# Reference
